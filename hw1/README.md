Аналитический сервис для прогнозирования потребления электроэнергии с использованием LSTM нейронных сетей и интерактивной визуализации данных.
О проекте

Проект представляет собой полнофункциональное веб-приложение для анализа и прогнозирования энергопотребления на основе реальных данных домохозяйств. Система использует современные методы машинного обучения для создания точных прогнозов и предоставляет интуитивно понятный интерфейс для работы с данными.
Основные возможности

    Анализ временных рядов - исследование паттернов потребления энергии

    LSTM прогнозирование - глубокое обучение для точных прогнозов

    Оптимизация гиперпараметров - автоматический подбор лучших параметров модели

    Интерактивная визуализация - богатые возможности для анализа данных

    Управление моделями - сохранение и загрузка обученных моделей

    Генерация отчетов - автоматическое создание аналитических отчетов

Быстрый старт
Предварительные требования

    Python 3.8 или выше

    pip (менеджер пакетов Python)

Установка

    Клонируйте репозиторий

bash

git clone https://github.com/dprotasovitsky/ds2_belhard.git
cd hw1

    Создайте виртуальное окружение (рекомендуется)

bash

python -m venv venv
source venv/bin/activate  # Linux/MacOS
# или
venv\Scripts\activate  # Windows

    Установите зависимости

bash

pip install -r requirements.txt

    Запустите приложение

bash

streamlit run main_app.py

    Откройте браузер и перейдите по адресу http://localhost:8501

Структура проекта

```
hw1/
├── main_app.py                # Главное приложение Streamlit
├── config/
│   └── settings.py            # Конфигурация приложения
├── data/
│   ├── loader.py              # Загрузка и предобработка данных
│   └── database.py            # Работа с базой данных SQLite
├── models/
│   ├── lstm_model.py          # Архитектуры LSTM моделей
│   ├── trainer.py             # Обучение моделей
│   ├── optimizer.py           # Оптимизация гиперпараметров
│   └── model_manager.py       # Управление моделями
├── visualization/
│   ├── dashboard.py           # Визуализация дашборда
│   └── lstm_results.py        # Визуализация результатов LSTM
├── utils/
│   └── helpers.py             # Вспомогательные функции
├── saved_models/              # Директория для сохраненных моделей
├── exports/                   # Директория для экспорта отчетов
├── requirements.txt           # Зависимости проекта
└── README.md                  # Документация
```

Использование
1. Загрузка данных

    Используйте реальные данные из файла household_power_consumption.txt

    Данные автоматически предобрабатываются и очищаются

2. Аналитика и визуализация

    Исследуйте временные ряды потребления

    Анализируйте сезонные паттерны

    Смотрите корреляции между показателями

    Сравнивайте потребление по дням недели и часам

3. LSTM прогнозирование
Настройка параметров:

    Период данных: Весь датасет / Последние 7/30/60 дней

    Стратегия оптимизации: Быстрая или Стандартная

    Агрегация данных: Минутные или часовые данные

    Длина последовательности: Настройка для LSTM

Процесс обучения:

    Подготовка данных - создание последовательностей для LSTM

    Оптимизация гиперпараметров - автоматический поиск лучших параметров

    Обучение модели - тренировка LSTM с ранней остановкой

    Оценка результатов - анализ метрик и визуализация прогнозов

4. Управление моделями

    Сохранение обученных моделей с метриками

    Загрузка предыдущих моделей

    Сравнение производительности разных моделей

    Удаление неактуальных моделей

Данные
Источник данных

Проект использует набор данных Household Power Consumption содержащий измерения энергопотребления домохозяйства с декабря 2006 по ноябрь 2010 года.
Показатели

    Global_active_power - общая активная мощность (кВт)

    Global_reactive_power - общая реактивная мощность (кВАр)

    Voltage - напряжение (В)

    Global_intensity - сила тока (А)

    Sub_metering_1 - кухня (кВт·ч)

    Sub_metering_2 - прачечная (кВт·ч)

    Sub_metering_3 - водонагреватель и кондиционер (кВт·ч)

Предобработка

    Автоматическое определение и заполнение пропущенных значений

    Добавление временных признаков (час, день недели, сезон)

    Нормализация данных для нейронных сетей

    Создание последовательностей для LSTM

Модели машинного обучения
Архитектура LSTM
python

AdvancedLSTMModel(
    input_size=7,           # Количество признаков
    hidden_size=128,        # Размер скрытого слоя
    num_layers=2,           # Количество LSTM слоев
    dropout=0.2,            # Регуляризация
    bidirectional=True,     # Двунаправленная LSTM
    use_attention=True      # Механизм внимания
)

Особенности реализации

    Двунаправленные LSTM - анализ временных рядов в обоих направлениях

    Механизм внимания - фокусировка на важных временных точках

    Ранняя остановка - предотвращение переобучения

    Оптимизация Optuna - автоматический поиск гиперпараметров

Метрики оценки

    MSE (Mean Squared Error) - средняя квадратичная ошибка

    RMSE (Root Mean Squared Error) - корень из MSE

    MAE (Mean Absolute Error) - средняя абсолютная ошибка

    R² (R-squared) - коэффициент детерминации

    MAPE (Mean Absolute Percentage Error) - средняя абсолютная процентная ошибка

Настройка
Конфигурация

Основные настройки находятся в config/settings.py:
python

class Config:
    DATA_FILE = "household_power_consumption.txt"
    DEVICE = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    DEFAULT_SEQUENCE_LENGTH = 24
    DEFAULT_OPTUNA_TRIALS = 30
    # ... другие настройки

Поддерживаемые устройства

    CPU - для небольших наборов данных

    GPU - автоматическое определение и использование CUDA

