## Реализовать yolo для детекции, сегментации или трекинга объектов в режиме реального времени исходя из своих интересов


### Для детекции объектов на записанном видео с помощью YOLOv5 были выполнены следующие шаги:
### 1. Установка YOLOv5

* Клонирование репозитория
```
bash

git clone https://github.com/ultralytics/yolov5
cd yolov5
```
* Установка зависимостей
```
bash

pip install -r requirements.txt
```

### 2. Для детекции слонов на видео с помощью YOLOv5 был создан собственный набор данных. Разметка для детекции была произведена в Label Studio и произведен экспорт в YOLO формате.

### Структура проекта
* Создание следующей структуры папок. Корневая папка датасета размещается рядом с папкой yolov5.

```
datasets/
└── elephants/
    ├── images/
    │   ├── train/         # <-- изображения для обучения
    │   └── val/           # <-- изображения для валидации
    └── labels/
        ├── train/         # <-- .txt файлы разметки для обучения
        └── val/           # <-- .txt файлы разметки для валидации

```

* Создание конфигурационного файла dataset.yaml. В нем указаны пути к изображениям и разметке, а также метка класса.
В корне папки elephants создан файл .yaml. Он сообщает модели пути к данным и названия классов.

```
yaml

# dataset.yaml
path: ../datasets/elephants  # Абсолютный или относительный путь к датасету
train: images/train  # Относительно path
val: images/val      # Относительно path

nc: 1  # Number of Classes (количество классов)
names: ['elephant']  # Имена классов
```

### Запуск обучения
* После подготовки данных и конфигурации, обучение запускается одним скриптом. Вот базовая команда из папки yolov5.
```
bash

python train.py \
  --img 640 \                  # Разрешение изображения на входе
  --batch 4 \                  # Размер батча (зависит от памяти GPU)
  --epochs 100 \               # Количество эпох обучения
  --data ../datasets/elephants/dataset.yaml \  # Путь к конфигу
  --weights yolov5m.pt \       # Начать обучение с предобученных весов
  --device 0                   # Использовать GPU с индексом 0 (если доступен)
```

* Ключевые параметры и мониторинг

   * Выбор модели: --weights yolov5m.pt —  модель для большей точности.

   * Мониторинг: Для визуализации процесса обучения используется TensorBoard.

```
bash

tensorboard --logdir runs/train
```

* Результаты: После обучения лучшие веса модели сохранятся в runs/train/exp/weights/best.pt.  Этот файл для используется для детекции.

### Детекция на видео

* Когда модель обучена, для детекции объектов на записанном видео используется скрипт detect.py


```
bash

python detect.py \
  --weights runs/train/exp/weights/best.pt \  # Путь к вашей обученной модели
  --source ../videoplayback.mp4  \           # Путь к исходному видео
  --conf-thres 0.75                           # Порог уверенности для детекции
```
* Обработанное видео с нарисованными ограничивающими рамками  сохранено в папке runs/detect/exp/
